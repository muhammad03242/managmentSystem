<div class="container">
  <div class="page-header">
    <div>
      <h1 class="page-title">{{ isEditMode ? 'Edit Employee' : 'Add New Employee' }}</h1>
      <p class="page-subtitle">{{ isEditMode ? 'Update employee information' : 'Fill in the details to add a new employee' }}</p>
    </div>
    <button mat-button routerLink="/employees">
      <mat-icon>arrow_back</mat-icon>
      Back to List
    </button>
  </div>

  <mat-card class="form-card">
    <mat-card-content>
      <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
        <div class="form-section">
          <h3 class="section-title">Personal Information</h3>
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" placeholder="Enter first name">
              <mat-icon matPrefix>person</mat-icon>
              @if (employeeForm.get('firstName')?.hasError('required') && employeeForm.get('firstName')?.touched) {
                <mat-error>First name is required</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" placeholder="Enter last name">
              <mat-icon matPrefix>person</mat-icon>
              @if (employeeForm.get('lastName')?.hasError('required') && employeeForm.get('lastName')?.touched) {
                <mat-error>Last name is required</mat-error>
              }
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email" type="email" placeholder="employee@hrms.gov.pk">
              <mat-icon matPrefix>email</mat-icon>
              @if (employeeForm.get('email')?.hasError('email') && employeeForm.get('email')?.touched) {
                <mat-error>Please enter a valid email</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Phone</mat-label>
              <input matInput formControlName="phone" placeholder="0300-1234567">
              <mat-icon matPrefix>phone</mat-icon>
              @if (employeeForm.get('phone')?.hasError('pattern') && employeeForm.get('phone')?.touched) {
                <mat-error>Format: 0300-1234567</mat-error>
              }
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>CNIC</mat-label>
              <input matInput formControlName="cnic" placeholder="42101-1234567-1">
              <mat-icon matPrefix>badge</mat-icon>
              @if (employeeForm.get('cnic')?.hasError('pattern') && employeeForm.get('cnic')?.touched) {
                <mat-error>Format: 42101-1234567-1</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Date of Birth</mat-label>
              <input matInput [matDatepicker]="dobPicker" formControlName="dateOfBirth">
              <mat-datepicker-toggle matSuffix [for]="dobPicker"></mat-datepicker-toggle>
              <mat-datepicker #dobPicker></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field-full">
              <mat-label>Gender</mat-label>
              <mat-select formControlName="gender">
                <mat-option value="Male">Male</mat-option>
                <mat-option value="Female">Female</mat-option>
                <mat-option value="Other">Other</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">Employment Details</h3>
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Designation</mat-label>
              <mat-select formControlName="designation">
                @for (designation of designations; track designation) {
                  <mat-option [value]="designation">{{ designation }}</mat-option>
                }
              </mat-select>
              <mat-icon matPrefix>work</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Department</mat-label>
              <mat-select formControlName="department">
                @for (department of departments; track department) {
                  <mat-option [value]="department">{{ department }}</mat-option>
                }
              </mat-select>
              <mat-icon matPrefix>business</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Joining Date</mat-label>
              <input matInput [matDatepicker]="joiningPicker" formControlName="joiningDate">
              <mat-datepicker-toggle matSuffix [for]="joiningPicker"></mat-datepicker-toggle>
              <mat-datepicker #joiningPicker></mat-datepicker>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Employment Type</mat-label>
              <mat-select formControlName="employmentType">
                <mat-option value="Permanent">Permanent</mat-option>
                <mat-option value="Contract">Contract</mat-option>
                <mat-option value="Temporary">Temporary</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Salary</mat-label>
              <input matInput formControlName="salary" type="number" placeholder="50000">
              <span matPrefix>Rs.&nbsp;</span>
              @if (employeeForm.get('salary')?.hasError('min') && employeeForm.get('salary')?.touched) {
                <mat-error>Salary must be positive</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Status</mat-label>
              <mat-select formControlName="status">
                <mat-option value="Active">Active</mat-option>
                <mat-option value="On Leave">On Leave</mat-option>
                <mat-option value="Inactive">Inactive</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">Deployment Location</h3>
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>District</mat-label>
              <mat-select formControlName="district" (selectionChange)="onDistrictChange($event.value)">
                @for (district of districts; track district) {
                  <mat-option [value]="district">{{ district }}</mat-option>
                }
              </mat-select>
              <mat-icon matPrefix>location_on</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>City</mat-label>
              <input matInput formControlName="city" placeholder="City">
              <mat-icon matPrefix>location_city</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field-full">
              <mat-label>Address</mat-label>
              <textarea matInput formControlName="address" rows="3" placeholder="Enter complete address"></textarea>
              <mat-icon matPrefix>home</mat-icon>
            </mat-form-field>
          </div>
        </div>

        <div class="form-actions">
          <button mat-raised-button type="button" (click)="onCancel()">
            <mat-icon>close</mat-icon>
            Cancel
          </button>
          <button mat-raised-button color="primary" type="submit">
            <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
            {{ isEditMode ? 'Update Employee' : 'Add Employee' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>

